<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Smart Inventory via NFC</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Sarabun', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f9;
      color: #333;
    }
    .container {
      max-width: 800px;
      margin: auto;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
    }
    .button {
      display: inline-block;
      margin: 10px;
      padding: 10px 20px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }
    .button:hover {
      background-color: #45a049;
    }
    .input-group {
      margin: 15px 0;
    }
    input, select {
      padding: 10px;
      width: 100%;
      box-sizing: border-box;
      margin-top: 5px;
    }
    .summary {
      background-color: #fff;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .summary-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    .lang-toggle {
      position: absolute;
      top: 10px;
      right: 10px;
    }
  </style>
</head>
<body>
  <div class="container" id="mainPage">
    <div class="lang-toggle">
      <button onclick="toggleLanguage()" class="button">EN/TH</button>
    </div>
    <h1 id="mainTitle">Smart Inventory</h1>
    <button onclick="goToCustomer()" class="button">Customer</button>
    <button onclick="goToAdmin()" class="button">Admin</button>
  </div>

  <div class="container" id="customerPage" style="display:none">
    <h2>Scan the product</h2>
    <div class="input-group">
      <label for="nfcInput">Tap NFC or type product code (C, T, S)</label>
      <input id="nfcInput" oninput="autoSuggest()" placeholder="e.g., C for Cleanser" />
    </div>
    <div class="input-group">
      <label for="quantity">Quantity</label>
      <input type="number" id="quantity" min="1" />
    </div>
    <button class="button" onclick="addToSummary()">Add to Summary</button>
    <div class="summary" id="summaryBox"></div>
    <button class="button" onclick="submitOrder()">Submit Order</button>
  </div>

  <div class="container" id="adminLogin" style="display:none">
    <h2>Enter Passcode</h2>
    <input type="password" id="adminPass" />
    <button class="button" onclick="checkPasscode()">Enter</button>
  </div>

  <div class="container" id="adminPage" style="display:none">
    <h2>Admin Stock Manager</h2>
    <div class="input-group">
      <label for="stockProduct">Product</label>
      <select id="stockProduct">
        <option value="Cleanser">Cleanser</option>
        <option value="Toner">Toner</option>
        <option value="Serum">Serum</option>
      </select>
    </div>
    <div class="input-group">
      <label for="stockAmount">Amount</label>
      <input type="number" id="stockAmount" />
    </div>
    <button class="button" onclick="updateStock('add')">Add Stock</button>
    <button class="button" onclick="updateStock('delete')">Delete Stock</button>
    <br /><br />
    <button class="button" onclick="goToServer()">Server</button>
  </div>

  <div class="container" id="serverPage" style="display:none">
    <h2>Server Logs</h2>
    const productPrices = {
      Cleanser: 10,
      Toner: 15,
      Serum: 20
    };
    let stock = {
      Cleanser: 10,
      Toner: 10,
      Serum: 10
    };
    let orderSummary = [];
    let logs = [];

    function goToCustomer() {
      showPage("customerPage");
    }
    function checkAdmin() {
      showPage("adminLogin");
    }
    function verifyAdmin() {
      const code = document.getElementById("adminCode").value;
      if (code === "12345") showPage("adminPage");
    }
    function goToServer() {
      showPage("serverPage");
      populateLogs();
    }
    function goToAdmin() {
      showPage("adminPage");
    }
    function goBackToMain() {
      showPage("mainPage");
    }

    function showPage(id) {
      document.querySelectorAll(".container").forEach(p => p.classList.add("hidden"));
      document.getElementById(id).classList.remove("hidden");
      if (id === "adminPage") populateStock();
    }

    function suggestProduct() {
      const val = document.getElementById("nfcInput").value.toUpperCase();
      const box = document.getElementById("suggestions");
      box.innerHTML = productMap[val] ? `<p>Suggestion: ${productMap[val]}</p>` : "";
    }

    function addToSummary() {
      const code = document.getElementById("nfcInput").value.toUpperCase();
      const qty = parseInt(document.getElementById("quantityInput").value);
      const product = productMap[code] || code;
      if (!productPrices[product] || qty <= 0) return;

      const existing = orderSummary.find(item => item.product === product);
      if (existing) existing.qty += qty;
      else orderSummary.push({ product, qty });

      updateSummaryTable();
      document.getElementById("nfcInput").value = "";
      document.getElementById("quantityInput").value = "";
    }

    function updateSummaryTable() {
      const tbody = document.getElementById("summaryTable").querySelector("tbody");
      tbody.innerHTML = "";
      orderSummary.forEach((item, i) => {
        const row = `<tr>
          <td>${item.product}</td>
          <td><input type='number' value='${item.qty}' onchange='editQty(${i}, this.value)'/></td>
          <td>${productPrices[item.product]}</td>
          <td>${item.qty * productPrices[item.product]}</td>
          <td><button onclick='removeItem(${i})'>Delete</button></td>
        </tr>`;
        tbody.innerHTML += row;
      });
    }

    function editQty(index, newQty) {
      orderSummary[index].qty = parseInt(newQty);
      updateSummaryTable();
    }

    function removeItem(index) {
      orderSummary.splice(index, 1);
      updateSummaryTable();
    }

    function submitOrder() {
      orderSummary.forEach(item => {
        stock[item.product] -= item.qty;
        logs.push({ action: "Order", product: item.product, qty: item.qty, time: new Date().toLocaleString() });
      });
      orderSummary = [];
      updateSummaryTable();
      alert("Order submitted!");
    }

    function populateStock() {
      const tbody = document.getElementById("stockTable").querySelector("tbody");
      tbody.innerHTML = "";
      Object.entries(stock).forEach(([p, q]) => {
        tbody.innerHTML += `<tr><td>${p}</td><td>${q}</td></tr>`;
      });
    }

    function addStock() {
      const p = document.getElementById("stockProduct").value;
      const q = parseInt(document.getElementById("stockAmount").value);
      stock[p] += q;
      logs.push({ action: "Add Stock", product: p, qty: q, time: new Date().toLocaleString() });
      populateStock();
    }

    function removeStock() {
      const p = document.getElementById("stockProduct").value;
      const q = parseInt(document.getElementById("stockAmount").value);
      stock[p] -= q;
      logs.push({ action: "Remove Stock", product: p, qty: q, time: new Date().toLocaleString() });
      populateStock();
    }

    function populateLogs() {
      const tbody = document.getElementById("logTable").querySelector("tbody");
      tbody.innerHTML = "";
      logs.forEach(log => {
        tbody.innerHTML += `<tr><td>${log.action}</td><td>${log.product}</td><td>${log.qty}</td><td>${log.time}</td></tr>`;
      });
    }
  </script>
</body>
</html>
